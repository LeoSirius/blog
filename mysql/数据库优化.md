# 数据库优化

## 概述

### 数据库优化目的

- 避免出现页面访问错误
  - 数据库连接超时造成的5xx错误
  - 慢查询造成页面无法加载
  - 阻塞造成数据无法提交

### 数据库优化的方面

（从上到下成本递增，优化效果递减）

- SQL及索引
- 数据库表结构
- 系统配置
- 硬件

## SQL语句优化

### 慢查询日志

- show variables like 'slow_query_log;'
- set global slow_query_log_file='/...'
- set global log_queries_not_using_indexes=on;  # 是否把没有索引的慢查询记录到日志里
- set global long_query_time=1;    # 超过多长时间的查询记录到慢查询日志中


