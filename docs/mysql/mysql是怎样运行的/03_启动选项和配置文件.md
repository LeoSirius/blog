# 启动选项和配置文件

## 在命令行上使用选项

在启动服务器程序的命令行后边指定启动选项的通用格式就是这样的

```bash
--启动选项1[=值1] --启动选项2[=值2] ... --启动选项n[=值n]
```

不允许客户端使用网络通信连接

```bash
mysqld --skip-networking  # --skip_networking也可以（单词之间可以用-，也可以用_）
```

指定默认存储引擎

```bash
mysqld --default-storage-engine=MyISAM
```

注意对大小写是敏感的，`-P`是指定端口，`-p`是输入密码

如果是用`mysqld_safe`来启动的话，它处理不了的选项会传给`mysqld`。如`mysqld_safe --skip-networking`实际上会是`mysqld --skip-networking`

## 配置文件中使用选项

### 配置文件的路径

命令行中的配置只对当前次启动生效，想要永久生效可以写到配置文件中。UNIX-like系统中mysql会按照以下路径寻找配置文件

|路径名|备注|
|-|-|
|/etc/my.cnf||
|/etc/mysql/my.cnf||
|SYSCONFDIR/my.cnf||
|$MYSQL_HOME/my.cnf|特定于服务器的选项（仅限服务器）|
|defaults-extra-file|命令行指定的额外配置文件路径|
|~/.my.cnf|用户特定选项|
|~/.mylogin.cnf|用户特定的登录路径选项（仅限客户端）|

> `SYSCONFDIR`是编译安装myqsl的时候指定的。`MYSQL_HOME`是环境变量

## 配置文件的内容

配置内容是分组的。不同的组给不同的启动命令使用。如，`[mysqld]`和[mysql]`组分别应用于mysqld服务器程序和mysql客户端程序。

两个特殊的组：

- `[server]`组下边的启动选项将作用于所有的服务器程序
- `[client]`组下边的启动选项将作用于所有的客户端程序。

```
[server]
(具体的启动选项...)

[mysqld]
(具体的启动选项...)

[mysqld_safe]
(具体的启动选项...)

[client]
(具体的启动选项...)

[mysql]
(具体的启动选项...)

[mysqladmin]
(具体的启动选项...)
```

> 命令行中选项的=周围不能有空格，配置文件中选项的=周围可以有空格

下面是启动命令对应的配置组：

|启动命令|类别|能读取的组|
|-|-|-|
|mysqld|启动服务器|[mysqld]、[server]|
|mysqld_safe|启动服务器|[mysqld]、[server]、[mysqld_safe]|
|mysql.server|启动服务器|[mysqld]、[server]、[mysql.server]|
|mysql|启动客户端|[mysql]、[client]|
|mysqladmin|启动客户端|[mysqladmin]、[client]|
|mysqldump|启动客户端|[mysqldump]、[client]|

对于特定版本的组，可以以`[mysqld-5.7]`的形式配置。这样只有5.7的mysqld会生效

### 配置文件的优先级

- 在不同的文件中有相同的选项，以最后一个为准
- 在同一文件的不同组中的相同选项，以最后一个为准
- 如果选在还在命令行中指定了，以命令行中指定的为准

如果不想用上面路径中搜索的配置文件，还在命令行中指定配置文件

```bash
mysqld --defaults-file=/tmp/myconfig.txt
```
