# 数据包大小对网络的影响

## 最大传输单元（Maximum Transmission Unit, MTU）

- MTU：数据链路层传输的帧的最大字节

下图是以太网的帧格式，以太网的帧最小的帧是 64 字节，除去 14 字节头部和 4 字节 CRC 字段，有效荷载最小为 46 字节。最大的帧是 1518 字节，除去 14 字节头部和 4 字节 CRC，有效荷载最大为 1500，这个值就是以太网的 MTU。因此如果传输 100KB 的数据，至少需要 （100 * 1024 / 1500) = 69 个以太网帧。

![以太网的帧格式](https://s1.ax1x.com/2020/10/16/0bBJJS.jpg)

不同的数据链路层的 MTU 是不同的。通过`netstat -i` 可以查看网卡的 mtu。（lo是localhost）

```bash
(base) root slt (master) # netstat -i
Kernel Interface table
Iface      MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
eth0      1500  1540408      0      0 0       1026255      0      0      0 BMRU
lo       65536   869483      0      0 0        869483      0      0      0 LRU
```

## IP分段

IPv4 数据报的最大大小为 65535 字节，这已经远远超过了以太网的 MTU，需要分段。

IP头部中有个字段是`分片偏移量（Fragment Offset）`，表示该分段在原始数据报文中的位置
